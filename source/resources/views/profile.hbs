<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Thông tin tài khoản</title>
    <link rel="stylesheet" href="/css/app.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
    <div class="information-box">
        <!-- Cột trái: Thông tin tài khoản -->
        <div class="info-box shadow">
            <h2><i class="fa-solid fa-user"></i> Thông tin tài khoản</h2>
            <p><strong><i class="fa-solid fa-user-tag"></i> Tên người dùng:</strong> {{user.username}}</p>
            <p><strong><i class="fa-solid fa-envelope"></i> Email:</strong> {{user.email}}</p>
            <p><strong><i class="fa-solid fa-venus-mars"></i> Giới tính:</strong> {{user.gender}}</p>
            <p><strong><i class="fa-solid fa-cake-candles"></i> Tuổi:</strong> {{user.age}}</p>
            <button id="edit-profile-btn" class="btn btn-warning btn-sm mt-2">Chỉnh sửa</button>
                <form id="edit-form" method="POST" action="/profile/edit" style="display: none;">
                    <input type="text" name="username" value="{{user.username}}">
                    <input type="email" name="email" value="{{user.email}}">
                    <select name="gender">
                        <option value="Nam" {{#ifEquals user.gender "Nam"}}selected{{/ifEquals}}>Nam</option>   
                        <option value="Nữ" {{#ifEquals user.gender "Nữ"}}selected{{/ifEquals}}>Nữ</option>
                    </select>
                    <input type="number" name="age" value="{{user.age}}">
                    <button type="submit">Lưu</button>
                </form>

        </div>

        <!-- Cột phải: chức năng -->
        <div class="function-area">
            <!-- Ô đỏ: Đổi avatar & mật khẩu -->
            <div class="function-box shadow">
                <h3><i class="fa-solid fa-image"></i> Ảnh đại diện</h3>
                <img src="{{#if user.avatar}}{{user.avatar}}{{else}}/uploads/avatars/default-avatar.png{{/if}}" alt="Avatar" class="avatar-preview" />

                {{!-- <form action="/profile/change-avatar" method="POST" enctype="multipart/form-data">
                    <input type="file" name="avatar" accept="image/*" required>
                    <button type="submit" class="btn btn-primary"><i class="fa-solid fa-upload"></i> Cập nhật ảnh đại diện</button>
                </form>
                <form action="/profile/delete-avatar" method="POST" onsubmit="return confirm('Bạn có chắc muốn xoá avatar hiện tại?');">
                    <button type="submit" class="btn btn-danger mt-4">Xoá avatar</button>
                </form> --}}
                
                <div class="avatar-form">
                    <form action="/profile/change-avatar" method="POST" enctype="multipart/form-data">
                        <input type="file" name="avatar" accept="image/*" required>
                        <div class="avatar-action-row">
                            <button type="submit" class="btn btn-info">
                                <i class="fa-solid fa-upload"></i> Cập nhật ảnh đại diện
                            </button>
                        </div>
                    </form>
                    <form action="/profile/delete-avatar" method="POST" onsubmit="return confirm('Bạn có chắc muốn xoá avatar hiện tại?');">
                        <div class="avatar-action-row">
                            <button type="submit" class="btn btn-danger">
                                Xoá avatar
                            </button>
                        </div>
                    </form>
                </div>

                
                <hr>
                <h3><i class="fa-solid fa-key"></i> Đổi mật khẩu</h3>
                <form action="/profile/change-password" method="POST">
                    <input type="password" name="currentPassword" placeholder="Mật khẩu hiện tại" required>
                    <input type="password" name="newPassword" placeholder="Mật khẩu mới" required>
                    <button type="submit" class="btn btn-warning"><i class="fa-solid fa-rotate"></i> Đổi mật khẩu</button>
                </form>
            </div>

            <!-- Ô vàng: Xoá và quay lại -->
            <div class="danger-box shadow">
                <form action="/profile/delete" method="POST" onsubmit="return confirm('Bạn có chắc chắn muốn xoá tài khoản không?');">
                    <button type="submit" class="btn btn-danger"><i class="fa-solid fa-trash"></i> Xoá tài khoản</button>
                </form>
                <a href="/" class="btn btn-back"><i class="fa-solid fa-left-long"></i> Quay về trang chủ</a>
            </div>
        </div>
    </div>

<script>
    document.getElementById("edit-profile-btn").addEventListener("click", function () {
        const form = document.getElementById("edit-form");
        form.style.display = form.style.display === "none" ? "block" : "none";
    });
</script>

{{#if success}}
<script>
    Swal.fire({
        icon: 'success',
        title: 'Thành công',
        text: '{{success}}',
        confirmButtonColor: '#3085d6'
    });
</script>
{{/if}}

{{#if error}}
<script>
    Swal.fire({
        icon: 'error',
        title: 'Lỗi',
        text: '{{error}}',
        confirmButtonColor: '#d33'
    });
</script>
{{/if}}

</body>

</html>
